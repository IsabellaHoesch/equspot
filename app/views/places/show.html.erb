<div class="container">
  <div class="parent-show">
    <div id="carouselExampleControls" class="carousel slide mt-3" data-ride="carousel">
      <div class="carousel-inner">
        <% @place.photos.each_with_index do |photo, index| %>
        <div class="carousel-item <%= index == 0 ? 'active' : '' %>">
          <%= cl_image_tag photo.key, class: "d-block w-100", width: 400, height: 300, fit: :fill_pad %>
        </div>
        <% end %>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>
  </div>

  <div class="child-show p-3">
    <div class="d-flex justify-content-between mt-1">
      <h5><%= @place.name %></h5>
      <% if @place.user == current_user %>
      <%= link_to "Edit", edit_place_path(@place) %>
      <% end %>
      <%= link_to place_favourites_path(@place), method: :post, params: { "favourite[place_id]" =>  @place.id } do %>
      <i class="fas fa-crown"></i>
      <% end %>
    </div>
    <div class="mt-1">
      <p><%= @place.description %></p>
    </div>
    <div class="d-flex justify-content-end pt-2 mr-2">
      <p><%= link_to 'Check in', place_visits_path(@place), class: "btn btn-outline-primary mt-1 w-100", method: :post%></p>
    </div>
  </div>


  <div class="parent-show-2">

    <div class="mt-4">
      <p id="weather" data-latitude="<%= @place.latitude %>" data-longitude="<%= @place.longitude %>" data-name="<%= @place.name %>" data-apikey="<%=ENV['WEATHER_API_KEY']%>"></p>
    </div>

    <div class="mt-4">
      <h5>Find it on the map</h5>
      <div id="map" class="mt-3"
        style="width: 100%; height: 250px;"
        data-markers="<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
    </div>

    <div class="mt-4">
      <span><%= @busyness %></span>
    </div>

    <div class="mt-4">
      <h5>Recent comments</h5>
      <% @place.reviews.order(created_at: :desc).limit(3).each do |review| %>
        <div id="show-flex" class="d-flex flex-row justify-content-left align-items-center p-2 mt-2">
          <div id="show-rating" class="mb-2">
            <select data-rating= <%= review.rating %> data-id= <%= review.id %> name="" class="review-rating" id= <%= "review-#{review.id}" %> >
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
          </div>
          <div id="show-rating">
            <%= review.content %>
          </div>
          <div id="show-bucket" >
            <%= link_to review_path(review),
            method: :delete,
            data: { confirm: "Are you sure?" } do %>
            <i class="fas fa-trash-alt"></i>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="mt-3 mb-4">
      <%= link_to 'Leave a comment', new_place_review_path(@place), class: "button btn btn-primary mt-2 w-100" %></p>
      <%= link_to "Chat", chatroom_path(@place.sport_types.first.chatroom), class: "button btn btn-primary mb-2 w-100" %>
    </div>

    <div class="mb-4">
      <p>just some space</p>
    </div>

  </div>
</div>
